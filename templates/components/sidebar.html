{% load static %}
{% load static tailwind_tags %}

<style>
    /* Sidebar animations */
    .sidebar-item {
        position: relative;
        padding: 0.75rem 1rem;
        margin: 0.25rem 0.5rem;
        border-radius: 12px;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        cursor: pointer;
        animation: slideInFromLeft 0.5s ease-out;
        animation-fill-mode: both;
        display: flex;
        align-items: center;
        gap: 0.75rem;
        color: #3b82f6;
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.05) 0%, rgba(139, 92, 246, 0.05) 100%);
        border: 1px solid rgba(59, 130, 246, 0.1);
    }
    
    @keyframes slideInFromLeft {
        from {
            opacity: 0;
            transform: translateX(-20px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }
    
    .sidebar-item:hover {
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.15) 0%, rgba(139, 92, 246, 0.15) 100%);
        transform: translateX(10px) scale(1.02);
        box-shadow: 0 8px 20px rgba(59, 130, 246, 0.2);
        border-color: rgba(59, 130, 246, 0.3);
        color: #1d4ed8;
    }
    
    .sidebar-item:hover .sidebar-icon {
        transform: scale(1.2) rotate(10deg);
        fill: #3b82f6;
    }
    
    .sidebar-item:hover .sidebar-text {
        transform: translateX(5px);
        font-weight: 600;
    }
    
    .sidebar-item::before {
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        height: 100%;
        width: 3px;
        background: linear-gradient(180deg, #3b82f6, #8b5cf6);
        border-radius: 0 2px 2px 0;
        transform: scaleY(0);
        transform-origin: top;
        transition: transform 0.3s ease;
    }
    
    .sidebar-item:hover::before {
        transform: scaleY(1);
    }
    
    /* Stagger animations */
    .sidebar-item:nth-child(1) { animation-delay: 0.1s; }
    .sidebar-item:nth-child(2) { animation-delay: 0.2s; }
    .sidebar-item:nth-child(3) { animation-delay: 0.3s; }
    .sidebar-item:nth-child(4) { animation-delay: 0.4s; }
    .sidebar-item:nth-child(5) { animation-delay: 0.5s; }
    .sidebar-item:nth-child(6) { animation-delay: 0.6s; }
    .sidebar-item:nth-child(7) { animation-delay: 0.7s; }
    .sidebar-item:nth-child(8) { animation-delay: 0.8s; }
    
    /* Active state */
    .sidebar-item.active {
        background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
        color: white;
        border-color: #3b82f6;
        box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3);
    }
    
    .sidebar-item.active::before {
        transform: scaleY(1);
        background: white;
    }
    
    .sidebar-item.active .sidebar-icon {
        fill: white;
        animation: iconPulse 2s infinite;
    }
    
    @keyframes iconPulse {
        0%, 100% {
            transform: scale(1);
        }
        50% {
            transform: scale(1.1);
        }
    }
    
    /* Sidebar icons */
    .sidebar-icon {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        min-width: 1rem;
        width: 1rem;
        height: 1rem;
        flex-shrink: 0;
    }
    
    /* Sidebar text */
    .sidebar-text {
        transition: all 0.3s ease;
        font-size: 0.875rem;
        font-weight: 500;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    
    /* Section headers */
    .sidebar-header {
        letter-spacing: 1px;
        text-transform: uppercase;
        color: #6b7280;
        font-weight: 600;
        padding: 0.5rem 1rem;
        margin-top: 1.5rem;
        position: relative;
        animation: fadeIn 0.5s ease-out;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }
    
    .sidebar-header::before {
        content: '';
        position: absolute;
        left: 0;
        top: 50%;
        width: 3px;
        height: 12px;
        background: linear-gradient(180deg, #3b82f6, #8b5cf6);
        border-radius: 2px;
        transform: translateY(-50%);
    }
    
    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    /* Section headers animation delay */
    .sidebar-header:nth-of-type(1) { animation-delay: 0.9s; }
    .sidebar-header:nth-of-type(2) { animation-delay: 1.1s; }
    
    /* Badge for notifications */
    .sidebar-badge {
        position: absolute;
        right: 0.75rem;
        background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        color: white;
        font-size: 0.625rem;
        padding: 0.125rem 0.375rem;
        border-radius: 9999px;
        animation: badgePulse 2s infinite;
    }
    
    @keyframes badgePulse {
        0%, 100% {
            box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7);
        }
        50% {
            box-shadow: 0 0 0 6px rgba(239, 68, 68, 0);
        }
    }
    
    /* Ripple effect */
    .sidebar-item {
        position: relative;
        overflow: hidden;
    }
    
    .sidebar-item::after {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        border-radius: 50%;
        background: rgba(59, 130, 246, 0.3);
        transform: translate(-50%, -50%);
        transition: width 0.6s, height 0.6s;
        z-index: 0;
    }
    
    .sidebar-item:active::after {
        width: 200px;
        height: 200px;
    }
    
    /* Logout item special styling */
    .sidebar-item.logout-item:hover {
        background: linear-gradient(135deg, rgba(239, 68, 68, 0.15) 0%, rgba(220, 38, 38, 0.15) 100%);
        border-color: rgba(239, 68, 68, 0.3);
        color: #dc2626;
    }
    
    .sidebar-item.logout-item:hover::before {
        background: linear-gradient(180deg, #ef4444, #dc2626);
    }
    
    .sidebar-item.logout-item:hover .sidebar-icon {
        fill: #ef4444;
    }
    
    /* Dark mode support */
    .dark .sidebar-item {
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%);
        border-color: rgba(59, 130, 246, 0.2);
        color: #93c5fd;
    }
    
    .dark .sidebar-item:hover {
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.2) 0%, rgba(139, 92, 246, 0.2) 100%);
        color: #bfdbfe;
    }
    
    .dark .sidebar-header {
        color: #9ca3af;
    }
    
    .dark .sidebar-item.active {
        background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
        color: white;
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
        .sidebar-item:hover {
            transform: translateX(5px) scale(1.01);
        }
        
        .sidebar-text {
            font-size: 0.8125rem;
        }
    }
    
    /* Sidebar container glow */
    .sidebar-container {
        position: relative;
        overflow: hidden;
    }
    
    .sidebar-container::before {
        content: '';
        position: absolute;
        top: -50%;
        right: -50%;
        width: 200px;
        height: 200px;
        background: radial-gradient(circle, rgba(59, 130, 246, 0.1) 0%, transparent 70%);
        border-radius: 50%;
        animation: glowPulse 6s ease-in-out infinite;
        z-index: 0;
    }
    
    @keyframes glowPulse {
        0%, 100% {
            transform: scale(1);
            opacity: 0.3;
        }
        50% {
            transform: scale(1.2);
            opacity: 0.5;
        }
    }
</style>

<div class="sidebar-container">
    <!-- Dashboard -->
    <a href="{% url 'home' %}" class="sidebar-item {% if request.path == '/' %}active{% endif %}">
        <div class="sidebar-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M11.47 3.841a.75.75 0 0 1 1.06 0l8.69 8.69a.75.75 0 1 0 1.06-1.061l-8.689-8.69a2.25 2.25 0 0 0-3.182 0l-8.69 8.69a.75.75 0 1 0 1.061 1.06l8.69-8.689Z" />
                <path d="m12 5.432 8.159 8.159c.03.03.06.058.091.086v6.198c0 1.035-.84 1.875-1.875 1.875H15a.75.75 0 0 1-.75-.75v-4.5a.75.75 0 0 0-.75-.75h-3a.75.75 0 0 0-.75.75V21a.75.75 0 0 1-.75.75H5.625a1.875 1.875 0 0 1-1.875-1.875v-6.198a2.29 2.29 0 0 0 .091-.086L12 5.432Z" />
            </svg>
        </div>
        <div class="sidebar-text">Dashboard</div>
        {% if request.path == '/' %}
        <span class="sidebar-badge"></span>
        {% endif %}
    </a>

    <!-- Expenses -->
    <a href="{% url 'expenses' %}" class="sidebar-item {% if 'expenses' in request.path %}active{% endif %}">
        <div class="sidebar-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M2.25 2.25a.75.75 0 0 0 0 1.5h1.386c.17 0 .318.114.362.278l2.558 9.592a3.752 3.752 0 0 0-2.806 3.63c0 .414.336.75.75.75h15.75a.75.75 0 0 0 0-1.5H5.378A2.25 2.25 0 0 1 7.5 15h11.218a.75.75 0 0 0 .674-.421 60.358 60.358 0 0 0 2.96-7.228.75.75 0 0 0-.525-.965A60.864 60.864 0 0 0 5.68 4.509l-.232-.867A1.875 1.875 0 0 0 3.636 2.25H2.25ZM3.75 20.25a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 20.25a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z" />
            </svg>
        </div>
        <div class="sidebar-text">Expenses</div>
        {% if 'expenses' in request.path %}
        <span class="sidebar-badge"></span>
        {% endif %}
    </a>

    <!-- Incomes -->
    <a href="{% url 'incomes' %}" class="sidebar-item {% if 'incomes' in request.path %}active{% endif %}">
        <div class="sidebar-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path fill-rule="evenodd" d="M5.478 5.559A1.5 1.5 0 0 1 6.912 4.5H9A.75.75 0 0 0 9 3H6.912a3 3 0 0 0-2.868 2.118l-2.411 7.838a3 3 0 0 0-.133.882V18a3 3 0 0 0 3 3h15a3 3 0 0 0 3-3v-4.162c0-.299-.045-.596-.133-.882l-2.412-7.838A3 3 0 0 0 17.088 3H15a.75.75 0 0 0 0 1.5h2.088a1.5 1.5 0 0 1 1.434 1.059l2.213 7.191H17.89a3 3 0 0 0-2.684 1.658l-.256.513a1.5 1.5 0 0 1-1.342.829h-3.218a1.5 1.5 0 0 1-1.342-.83l-.256-.512a3 3 0 0 0-2.684-1.658H3.265l2.213-7.191Z" clip-rule="evenodd" />
                <path fill-rule="evenodd" d="M12 2.25a.75.75 0 0 1 .75.75v6.44l1.72-1.72a.75.75 0 1 1 1.06 1.06l-3 3a.75.75 0 0 1-1.06 0l-3-3a.75.75 0 0 1 1.06-1.06l1.72 1.72V3a.75.75 0 0 1 .75-.75Z" clip-rule="evenodd" />
            </svg>
        </div>
        <div class="sidebar-text">Incomes</div>
        {% if 'incomes' in request.path %}
        <span class="sidebar-badge"></span>
        {% endif %}
    </a>

    <!-- SUMMARY Section -->
    <div class="sidebar-header">
        <span>üìä</span> SUMMARY
    </div>
    
    <!-- Expense Summary -->
    <a href="{% url 'expense-stats' %}" class="sidebar-item {% if 'expense-stats' in request.path %}active{% endif %}">
        <div class="sidebar-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.5 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625Z" />
                <path d="M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z" />
            </svg>
        </div>
        <div class="sidebar-text">Expense Summary</div>
        {% if 'expense-stats' in request.path %}
        <span class="sidebar-badge"></span>
        {% endif %}
    </a>

    <!-- Income Summary -->
    <a href="{% url 'income-stats' %}" class="sidebar-item {% if 'income-stats' in request.path %}active{% endif %}">
        <div class="sidebar-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.5 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625Z" />
                <path d="M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z" />
            </svg>
        </div>
        <div class="sidebar-text">Income Summary</div>
        {% if 'income-stats' in request.path %}
        <span class="sidebar-badge"></span>
        {% endif %}
    </a>

    <!-- SETTINGS Section -->
    <div class="sidebar-header">
        <span>‚öôÔ∏è</span> SETTINGS
    </div>
    
    <!-- General Settings -->
    <a href="{% url 'preference' %}" class="sidebar-item {% if 'preference' in request.path %}active{% endif %}">
        <div class="sidebar-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path fill-rule="evenodd" d="M11.828 2.25c-.916 0-1.699.663-1.85 1.567l-.091.549a.798.798 0 0 1-.517.608 7.45 7.45 0 0 0-.478.198.798.798 0 0 1-.796-.064l-.453-.324a1.875 1.875 0 0 0-2.416.2l-.243.243a1.875 1.875 0 0 0-.2 2.416l.324.453a.798.798 0 0 1 .064.796 7.448 7.448 0 0 0-.198.478.798.798 0 0 1-.608.517l-.55.092a1.875 1.875 0 0 0-1.566 1.849v.344c0 .916.663 1.699 1.567 1.85l.549.091c.281.047.508.25.608.517.06.162.127.321.198.478a.798.798 0 0 1-.064.796l-.324.453a1.875 1.875 0 0 0 .2 2.416l.243.243c.648.648 1.67.733 2.416.2l.453-.324a.798.798 0 0 1 .796-.064c.157.071.316.137.478.198.267.1.47.327.517.608l.092.55c.15.903.932 1.566 1.849 1.566h.344c.916 0 1.699-.663 1.85-1.567l.091-.549a.798.798 0 0 1 .517-.608 7.52 7.52 0 0 0 .478-.198.798.798 0 0 1 .796.064l.453.324a1.875 1.875 0 0 0 2.416-.2l.243-.243c.648-.648.733-1.67.2-2.416l-.324-.453a.798.798 0 0 1-.064-.796c.071-.157.137-.316.198-.478.1-.267.327-.47.608-.517l.55-.091a1.875 1.875 0 0 0 1.566-1.85v-.344c0-.916-.663-1.699-1.567-1.85l-.549-.091a.798.798 0 0 1-.608-.517 7.507 7.507 0 0 0-.198-.478.798.798 0 0 1 .064-.796l.324-.453a1.875 1.875 0 0 0-.2-2.416l-.243-.243a1.875 1.875 0 0 0-2.416-.2l-.453.324a.798.798 0 0 1-.796.064 7.462 7.462 0 0 0-.478-.198.798.798 0 0 1-.517-.608l-.091-.55a1.875 1.875 0 0 0-1.85-1.566h-.344ZM12 15.75a3.75 3.75 0 1 0 0-7.5 3.75 3.75 0 0 0 0 7.5Z" clip-rule="evenodd" />
            </svg>
        </div>
        <div class="sidebar-text">General</div>
        {% if 'preference' in request.path %}
        <span class="sidebar-badge"></span>
        {% endif %}
    </a>

    <!-- Account Settings -->
    <a href="{% url 'profile' %}" class="sidebar-item {% if 'profile' in request.path %}active{% endif %}">
        <div class="sidebar-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path fill-rule="evenodd" d="M7.5 6a4.5 4.5 0 1 1 9 0 4.5 4.5 0 0 1-9 0ZM3.751 20.105a8.25 8.25 0 0 1 16.498 0 .75.75 0 0 1-.437.695A18.683 18.683 0 0 1 12 22.5c-2.786 0-5.433-.608-7.812-1.7a.75.75 0 0 1-.437-.695Z" clip-rule="evenodd" />
            </svg>
        </div>
        <div class="sidebar-text">Account</div>
        {% if 'profile' in request.path %}
        <span class="sidebar-badge"></span>
        {% endif %}
    </a>

    <!-- Logout -->
    <a href="{% url 'logout' %}" class="sidebar-item logout-item">
        <div class="sidebar-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path fill-rule="evenodd" d="M7.5 3.75A1.5 1.5 0 0 0 6 5.25v13.5a1.5 1.5 0 0 0 1.5 1.5h6a1.5 1.5 0 0 0 1.5-1.5V15a.75.75 0 0 1 1.5 0v3.75a3 3 0 0 1-3 3h-6a3 3 0 0 1-3-3V5.25a3 3 0 0 1 3-3h6a3 3 0 0 1 3 3V9A.75.75 0 0 1 15 9V5.25a1.5 1.5 0 0 0-1.5-1.5h-6Zm5.03 4.72a.75.75 0 0 1 0 1.06l-1.72 1.72h10.94a.75.75 0 0 1 0 1.5H10.81l1.72 1.72a.75.75 0 1 1-1.06 1.06l-3-3a.75.75 0 0 1 0-1.06l3-3a.75.75 0 0 1 1.06 0Z" clip-rule="evenodd" />
            </svg>
        </div>
        <div class="sidebar-text">Sign out</div>
    </a>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Add hover effect to sidebar items
        const sidebarItems = document.querySelectorAll('.sidebar-item');
        
        sidebarItems.forEach(item => {
            // Add ripple effect on click
            item.addEventListener('click', function(e) {
                const rect = this.getBoundingClientRect();
                const ripple = document.createElement('span');
                const size = Math.max(rect.width, rect.height);
                const x = e.clientX - rect.left - size / 2;
                const y = e.clientY - rect.top - size / 2;
                
                ripple.style.cssText = `
                    position: absolute;
                    border-radius: 50%;
                    background: rgba(59, 130, 246, 0.3);
                    transform: scale(0);
                    animation: ripple 0.6s linear;
                    width: ${size}px;
                    height: ${size}px;
                    top: ${y}px;
                    left: ${x}px;
                    pointer-events: none;
                    z-index: 1;
                `;
                
                this.appendChild(ripple);
                
                setTimeout(() => {
                    ripple.remove();
                }, 600);
            });
            
            // Add keyboard navigation
            item.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    this.click();
                }
            });
            
            // Add focus styles
            item.addEventListener('focus', function() {
                this.style.transform = 'translateX(10px) scale(1.02)';
                this.style.boxShadow = '0 8px 20px rgba(59, 130, 246, 0.2)';
            });
            
            item.addEventListener('blur', function() {
                if (!this.classList.contains('active')) {
                    this.style.transform = 'translateX(0) scale(1)';
                    this.style.boxShadow = 'none';
                }
            });
        });
        
        // Add ripple animation to CSS
        const rippleStyle = document.createElement('style');
        rippleStyle.textContent = `
            @keyframes ripple {
                to {
                    transform: scale(4);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(rippleStyle);
        
        // Highlight current page
        const currentPath = window.location.pathname;
        sidebarItems.forEach(item => {
            const href = item.getAttribute('href');
            if (href && currentPath.includes(href.replace('/', ''))) {
                item.classList.add('active');
            }
        });
        
        // Add subtle animation to active item
        const activeItem = document.querySelector('.sidebar-item.active');
        if (activeItem) {
            setInterval(() => {
                activeItem.style.boxShadow = `
                    0 8px 20px rgba(59, 130, 246, ${0.2 + Math.sin(Date.now() / 1000) * 0.1})
                `;
            }, 100);
        }
        
        // Add tooltips for better UX
        sidebarItems.forEach(item => {
            const text = item.querySelector('.sidebar-text').textContent;
            item.setAttribute('title', text);
            
            // Add micro-interaction on hover
            item.addEventListener('mouseenter', function() {
                const icon = this.querySelector('.sidebar-icon');
                if (icon) {
                    icon.style.transform = 'scale(1.2) rotate(10deg)';
                }
            });
            
            item.addEventListener('mouseleave', function() {
                const icon = this.querySelector('.sidebar-icon');
                if (icon && !this.classList.contains('active')) {
                    icon.style.transform = 'scale(1) rotate(0deg)';
                }
            });
        });
        
        // Add scroll reveal animation
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.animationPlayState = 'running';
                }
            });
        }, observerOptions);
        
        // Pause animations initially
        sidebarItems.forEach(item => {
            item.style.animationPlayState = 'paused';
            observer.observe(item);
        });
        
        // Animate section headers
        const headers = document.querySelectorAll('.sidebar-header');
        headers.forEach(header => {
            header.style.animationPlayState = 'paused';
            observer.observe(header);
        });
    });
</script>