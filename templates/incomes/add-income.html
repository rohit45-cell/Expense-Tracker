{% extends 'base.html' %}
{% block content %}

<style>
/* ===== PAGE ENTRY ===== */
.container-income {
    animation: fadeUp 0.8s ease-out;
}
@keyframes fadeUp {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
}

/* ===== CARD ===== */
.income-card {
    background: rgba(255,255,255,0.96);
    backdrop-filter: blur(10px);
    border-radius: 16px;
    box-shadow: 0 25px 50px rgba(0,0,0,0.08);
    animation: scaleIn 0.6s ease-out;
}
@keyframes scaleIn {
    from { opacity: 0; transform: scale(0.95); }
    to { opacity: 1; transform: scale(1); }
}

/* ===== INPUTS ===== */
.income-input, select {
    transition: all 0.3s ease;
    border-width: 2px !important;
}
.income-input:focus, select:focus {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(34,197,94,0.35);
    border-color: #22c55e !important;
}

/* ===== BUTTON ===== */
.income-btn {
    background: linear-gradient(135deg,#22c55e,#16a34a);
    transition: all 0.4s ease;
    box-shadow: 0 12px 30px rgba(34,197,94,0.35);
}
.income-btn:hover {
    transform: translateY(-3px) scale(1.05);
    box-shadow: 0 18px 40px rgba(34,197,94,0.45);
}
.income-btn.loading {
    pointer-events: none;
    background: #22c55e;
    position: relative;
    color: transparent;
}
.income-btn.loading::after {
    content: '';
    width: 22px;
    height: 22px;
    border: 3px solid white;
    border-top-color: transparent;
    border-radius: 50%;
    position: absolute;
    inset: 0;
    margin: auto;
    animation: spin 1s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }

/* ===== FLOW BAR ===== */
.income-flow {
    height: 4px;
    background: linear-gradient(90deg,#22c55e,#16a34a,#22c55e);
    background-size: 200% 100%;
    animation: flow 3s linear infinite;
    border-radius: 10px;
}
@keyframes flow {
    from { background-position: 200% 0; }
    to { background-position: -200% 0; }
}

/* ===== MOBILE ===== */
@media(max-width:768px){
    .income-card{ margin:0 1rem; }
}
</style>

<div class="container-income container mx-auto mt-8">

    <!-- Breadcrumb -->
    <nav class="flex mb-4 text-xl mx-4">
        <a href="{% url 'incomes' %}" class="text-green-600 font-semibold hover:underline">
            Incomes
        </a>
        <span class="mx-2 text-gray-400">/</span>
        <span class="text-gray-500">Add Income</span>
    </nav>

    <div class="income-flow mx-4 mb-6"></div>

    <div class="income-card p-6 max-w-2xl mx-auto">

        <h2 class="text-2xl font-bold text-gray-800 mb-2 flex items-center gap-2">
            ðŸ’° Add New Income
        </h2>
        <p class="text-sm text-gray-500 mb-6">
            Track your earnings and manage your finances better
        </p>

        <form method="post" action="{% url 'add-income' %}" id="incomeForm">
            {% csrf_token %}
            {% include 'components/messages.html' %}

            <!-- Amount -->
            <div class="mb-4">
                <label class="font-semibold text-gray-700">Amount</label>
                <input type="text" name="amount" id="amount" required
                       placeholder="0.00"
                       value="{{ values.amount }}"
                       class="income-input w-full mt-2 px-4 py-3 rounded-md border border-gray-300">
            </div>

            <!-- Description -->
            <div class="mb-4">
                <label class="font-semibold text-gray-700">Description</label>
                <input type="text" name="description" required
                       placeholder="Salary / Freelance / Bonus"
                       value="{{ values.description }}"
                       class="income-input w-full mt-2 px-4 py-3 rounded-md border border-gray-300">
            </div>

            <!-- Source -->
            <div class="mb-4">
                <label class="font-semibold text-gray-700">Source</label>
                <select name="source" required
                        class="w-full mt-2 px-4 py-3 rounded-md border border-gray-300">
                    <option disabled selected>Select income source</option>
                    {% for source in sources %}
                    <option value="{{ source.name }}">ðŸ’¼ {{ source.name }}</option>
                    {% endfor %}
                </select>
            </div>

            <!-- Date -->
            <div class="mb-6">
                <label class="font-semibold text-gray-700">Date</label>
                <input type="date" name="date" required
                       value="{{ values.date }}"
                       class="income-input w-full mt-2 px-4 py-3 rounded-md border border-gray-300">
            </div>

            <!-- Buttons -->
            <div class="flex gap-3">
                <button type="submit" class="income-btn flex-1 text-white py-3 rounded-lg font-semibold">
                    Add Income
                </button>
                <a href="{% url 'incomes' %}"
                   class="flex-1 text-center py-3 rounded-lg bg-gray-200 font-semibold hover:bg-gray-300">
                    Cancel
                </a>
            </div>

        </form>
    </div>
</div>

<script>
document.getElementById('incomeForm').addEventListener('submit', function () {
    const btn = document.querySelector('.income-btn');
    btn.classList.add('loading');
});
</script>

{% endblock %}
